package main

import (
	"fmt"
)

type ListNode struct {
	Val  int
	Next *ListNode
}

func isContinue(cur *ListNode, k int) bool {
	count1 := 0
	for cur != nil {
		count1++
		cur = cur.Next
		if count1 >= k {
			break
		}
	}
	if count1 < k {
		return false
	}
	return true
}

func reverseKGroup(head *ListNode, k int) *ListNode {
	// write code here

	if k <= 1 || !isContinue(head, k) {
		return head
	}

	result := &ListNode{
		Next: head,
	}
	result2 := result

	cur := result.Next
	first := cur

	i := 0
	for cur != nil && cur.Next != nil {
		i++
		next := cur.Next
		cur.Next = next.Next
		next.Next = first
		first = next
		result2.Next = first
		if i%(k-1) == 0 {
			result2 = cur
			cur = cur.Next
			first = cur

			if !isContinue(cur, k) {
				return result.Next
			}
		}
	}

	return result.Next
}

func main() {

	arr := []int{258, 419, 140, 384, 271, 232, 388, 324, 394, 131, 355, 113, 79, 402, 304, 437, 196, 230, 289, 356, 493, 268, 425, 305, 384, 326, 332, 44, 341, 230, 375, 99, 1, 367, 335, 124, 100, 224, 448, 494, 207, 156, 108, 286, 58, 264, 76, 106, 347, 217, 462, 340, 486, 240, 145, 370, 418, 330, 266, 111, 412, 494, 63, 413, 361, 398, 38, 313, 474, 338, 160, 181, 494, 120, 320, 404, 384, 248, 10, 231, 465, 325, 423, 303, 65, 421, 26, 335, 251, 144, 446, 163, 138, 9, 428, 352, 260, 466, 17, 86, 157, 177, 268, 151, 149, 440, 408, 386, 40, 270, 469, 357, 95, 393, 161, 12, 314, 39, 347, 417, 183, 294, 80, 322, 303, 8, 26, 63, 327, 43, 150, 484, 73, 270, 487, 222, 62, 247, 460, 454, 18, 430, 163, 113, 323, 176, 126, 489, 215, 473, 406, 399, 119, 486, 73, 275, 346, 451, 190, 25, 346, 192, 9, 419, 314, 349, 494, 228, 96, 454, 182, 114, 384, 198, 80, 59, 374, 206, 48, 442, 31, 454, 341, 3, 292, 266, 278, 139, 217, 468, 16, 415, 13, 378, 335, 327, 227, 181, 56, 175, 487, 90, 290, 372, 288, 222, 431, 15, 428, 332, 457, 311, 286, 150, 314, 79, 416, 92, 70, 485, 413, 438, 400, 278, 316, 87, 105, 395, 120, 13, 71, 108, 456, 213, 480, 96, 435, 263, 111, 215, 447, 68, 26, 234, 218, 341, 165, 486, 285, 87, 323, 50, 25, 76, 328, 194, 15, 286, 89, 136, 299, 160, 244, 107, 225, 76, 204, 160, 191, 315, 375, 139, 236, 402, 225, 306, 95, 390, 145, 380, 329, 468, 283, 206, 396, 111, 400, 412, 397, 490, 400, 49, 2, 144, 156, 228, 72, 360, 388, 263, 28, 116, 254, 264, 370, 479, 70, 465, 221, 215, 197, 50, 36, 480, 109, 432, 92, 9, 196, 341, 351, 96, 390, 354, 92, 47, 82, 16, 407, 322, 280, 435, 438, 386, 51, 160, 366, 474, 125, 439, 41, 175, 342, 77, 155, 451, 362, 99, 460, 410, 293, 312, 359, 183, 18, 451, 82, 452, 468, 342, 274, 100, 129, 65, 486, 181, 225, 204, 155, 203, 144, 48, 378, 486, 126, 385, 289, 340, 337, 249, 102, 130, 413, 461, 165, 283, 413, 248, 235, 233, 90, 10, 185, 219, 427, 23, 252, 152, 228, 259, 355, 224, 308, 85, 62, 286, 471, 351, 478, 308, 452, 80, 290, 218, 42, 455, 1, 307, 203, 237, 392, 145, 99, 77, 217, 26, 100, 321, 30, 180, 81, 386, 256, 241, 471, 318, 27, 294, 21, 357, 102, 326, 289, 392, 44, 183, 200, 45, 490, 403, 134, 234, 401, 233, 163, 470, 259, 116, 291, 290, 296, 372, 28, 405, 465, 351, 75, 344, 146, 97, 201, 100, 423, 491, 345, 319, 174, 45, 364, 17, 300, 351, 103, 201, 84, 267, 171, 196, 383, 315, 338, 31, 187, 366, 436, 153, 69, 12, 497, 215, 461, 51, 316, 236, 42, 13, 55, 68, 58, 271, 437, 358, 122, 41, 412, 59, 308, 435, 255, 43, 250, 93, 74, 290, 311, 363, 295, 232, 227, 292, 448, 188, 195, 116, 276, 89, 129, 183, 158, 39, 306, 95, 397, 281, 488, 161, 340, 296, 97, 447, 339, 347, 392, 266, 137, 203, 129, 432, 287, 356, 77, 235, 396, 124, 203, 172, 214, 184, 207, 224, 223, 13, 171, 473, 294, 160, 134, 486, 308, 83, 433, 0, 431, 325, 266, 420, 380, 247, 205, 168, 455, 282, 255, 351, 258, 311, 375, 472, 495, 434, 196, 71, 447, 220, 396, 94, 380, 382, 80, 40, 466, 14, 40, 249, 191, 158, 21, 72, 257, 226, 92, 212, 360, 347, 415, 119, 158, 142, 443, 6, 76, 140, 429, 376, 360, 177, 470, 92, 59, 402, 132, 377, 268, 25, 478, 460, 183, 0, 384, 441, 78, 476, 5, 439, 175, 421, 410, 186, 63, 353, 192, 492, 493, 473, 368, 205, 150, 190, 149, 209, 92, 134, 439, 213, 159, 417, 173, 194, 269, 409, 135, 348, 237, 141, 287, 412, 414, 197, 98, 477, 402, 142, 321, 248, 115, 189, 305, 265, 231, 455, 327, 324, 441, 266, 37, 100, 35, 62, 294, 305, 323, 282, 153, 60, 423, 292, 324, 337, 341, 423, 166, 243, 417, 340, 491, 33, 29, 297, 150, 261, 104, 329, 437, 45, 95, 326, 497, 483, 240, 291, 140, 63, 73, 293, 475, 348, 437, 299, 37, 278, 222, 56, 373, 492, 396, 217, 25, 277, 366, 27, 390, 322, 357, 179, 367, 304, 5, 364, 287, 97, 7, 427, 160, 433, 72, 135, 281, 9, 287, 171, 139, 361, 227, 365, 353, 123, 434, 378, 252, 300, 258, 143, 122, 115, 322, 341, 419, 180, 205, 59, 277, 64, 486, 438, 497, 411, 425, 279, 272, 212, 450, 264, 74, 29, 129, 427, 152, 63, 158, 404, 215, 416, 399, 337, 383, 222, 178, 302, 402, 235, 361, 179, 299, 200, 469, 297, 111, 247, 428, 235, 311, 378, 499, 385, 407, 128, 165, 411, 43, 175, 167, 258, 443, 67, 447, 326, 141, 125, 480, 43, 212, 342, 74, 12, 394, 396, 161, 5, 143, 89, 92, 454, 319, 92, 192, 226, 72, 209, 489, 116, 236, 8, 226, 179, 75, 26, 357, 68, 151, 337, 463, 216, 31, 38, 228, 425, 286, 389, 282, 429, 478, 375, 235, 297, 467, 279, 375, 391, 340, 216, 359, 76, 224, 86, 107, 152, 112, 464, 220, 115, 154, 184, 183, 185, 74, 411, 111, 360, 152, 393, 141, 482, 268, 228, 131, 87, 8, 358, 479, 348, 74, 190, 277, 151, 276, 384, 303, 240, 201, 375, 208, 355, 411, 391, 40, 337, 155, 151, 49, 307, 397, 190, 142, 17, 271, 273, 105, 279, 132, 436, 479, 206, 126, 256, 209, 255, 493, 364, 347, 194, 240, 407, 49, 3, 299, 441, 341, 306, 93, 390, 465, 490, 433, 107, 359, 204, 381, 464, 335, 365, 252, 314, 423, 231, 423, 133, 486, 268, 497, 185, 462, 89, 93, 363, 93, 244, 156, 434, 50, 249, 176, 15, 91, 109, 475, 451, 313, 208, 267, 148, 73, 372, 315, 496, 103, 90, 481, 441, 358, 479, 126, 172, 68, 71, 387, 13, 315, 43, 299, 365, 293, 476, 233, 236, 85, 208, 39, 251, 416, 159, 251, 341, 383, 66, 337, 486, 156, 171, 279, 14, 150, 257, 38, 70, 329, 425, 436, 144, 469, 235, 362, 114, 211, 95, 202, 149, 155, 242, 252, 71, 253, 3, 264, 136, 422, 453, 474, 78, 124, 253, 445, 126, 10, 483, 197, 339, 409, 485, 336, 230, 220, 198, 344, 284, 293, 46, 433, 300, 140, 37, 223, 393, 40, 487, 381, 462, 440, 355, 393, 65, 460, 190, 191, 323, 25, 240, 14, 286, 225, 350, 16, 446, 400, 360, 82, 193, 259, 367, 493, 399, 404, 216, 145, 296, 55, 26, 111, 496, 234, 4, 61, 194, 46, 104, 369, 71, 345, 384, 358, 422, 86, 226, 368, 487, 87, 302, 32, 198, 169, 378, 97, 73, 446, 242, 370, 2, 269, 481, 498, 3, 337, 411, 49, 235, 15, 271, 306, 360, 155, 16, 283, 93, 95, 3, 80, 34, 158, 465, 232, 327, 343, 329, 253, 289, 72, 475, 143, 193, 308, 141, 48, 145, 404, 97, 232, 420, 368, 390, 132, 375, 407, 267, 469, 354, 123, 401, 388, 281, 366, 120, 108, 61, 449, 213, 203, 373, 188, 346, 66, 496, 340, 466, 493, 244, 416, 225, 164, 284, 116, 297, 12, 375, 416, 333, 229, 39, 86, 117, 320, 305, 89, 281, 366, 390, 494, 69, 264, 183, 268, 182, 31, 108, 149, 25, 352, 65, 102, 17, 201, 218, 166, 65, 445, 82, 250, 174, 122, 337, 143, 294, 142, 84, 427, 360, 475, 422, 430, 91, 457, 198, 125, 340, 306, 274, 365, 158, 191, 320, 27, 245, 38, 193, 162, 484, 128, 413, 10, 102, 250, 6, 248, 244, 90, 176, 104, 417, 450, 386, 8, 259, 84, 134, 99, 242, 260, 317, 253, 304, 137, 132, 401, 27, 178, 63, 363, 306, 328, 226, 260, 78, 232, 8, 174, 174, 184, 279, 444, 486, 165, 452, 245, 102, 438, 197, 196, 51, 14, 449, 207, 3, 434, 108, 30, 112, 23, 246, 270, 352, 472, 30, 430, 56, 38, 457, 230, 75, 236, 26, 61, 253, 331, 307, 355, 269, 4, 404, 172, 370, 353, 379, 225, 139, 339, 107, 251, 363, 353, 21, 215, 325, 51, 497, 233, 442, 454, 316, 17, 42, 342, 78, 296, 173, 237, 3, 295, 93, 407, 467, 315, 113, 199, 40, 252, 38, 148, 4, 401, 353, 377, 116, 31, 281, 466, 264, 223, 420, 80, 92, 463, 423, 22, 259, 96, 260, 114, 243, 205, 22, 63, 21, 135, 262, 61, 239, 152, 61, 95, 54, 415}
	arr2 := []int{323, 305, 294, 62, 35, 100, 37, 266, 441, 324, 327, 455, 231, 265, 305, 189, 115, 248, 321, 142, 402, 477, 98, 197, 414, 412, 287, 141, 237, 348, 135, 409, 269, 194, 173, 417, 159, 213, 439, 134, 92, 209, 149, 190, 150, 205, 368, 473, 493, 492, 192, 353, 63, 186, 410, 421, 175, 439, 5, 476, 78, 441, 384, 0, 183, 460, 478, 25, 268, 377, 132, 402, 59, 92, 470, 177, 360, 376, 429, 140, 76, 6, 443, 142, 158, 119, 415, 347, 360, 212, 92, 226, 257, 72, 21, 158, 191, 249, 40, 14, 466, 40, 80, 382, 380, 94, 396, 220, 447, 71, 196, 434, 495, 472, 375, 311, 258, 351, 255, 282, 455, 168, 205, 247, 380, 420, 266, 325, 431, 0, 433, 83, 308, 486, 134, 160, 294, 473, 171, 13, 223, 224, 207, 184, 214, 172, 203, 124, 396, 235, 77, 356, 287, 432, 129, 203, 137, 266, 392, 347, 339, 447, 97, 296, 340, 161, 488, 281, 397, 95, 306, 39, 158, 183, 129, 89, 276, 116, 195, 188, 448, 292, 227, 232, 295, 363, 311, 290, 74, 93, 250, 43, 255, 435, 308, 59, 412, 41, 122, 358, 437, 271, 58, 68, 55, 13, 42, 236, 316, 51, 461, 215, 497, 12, 69, 153, 436, 366, 187, 31, 338, 315, 383, 196, 171, 267, 84, 201, 103, 351, 300, 17, 364, 45, 174, 319, 345, 491, 423, 100, 201, 97, 146, 344, 75, 351, 465, 405, 28, 372, 296, 290, 291, 116, 259, 470, 163, 233, 401, 234, 134, 403, 490, 45, 200, 183, 44, 392, 289, 326, 102, 357, 21, 294, 27, 318, 471, 241, 256, 386, 81, 180, 30, 321, 100, 26, 217, 77, 99, 145, 392, 237, 203, 307, 1, 455, 42, 218, 290, 80, 452, 308, 478, 351, 471, 286, 62, 85, 308, 224, 355, 259, 228, 152, 252, 23, 427, 219, 185, 10, 90, 233, 235, 248, 413, 283, 165, 461, 413, 130, 102, 249, 337, 340, 289, 385, 126, 486, 378, 48, 144, 203, 155, 204, 225, 181, 486, 65, 129, 100, 274, 342, 468, 452, 82, 451, 18, 183, 359, 312, 293, 410, 460, 99, 362, 451, 155, 77, 342, 175, 41, 439, 125, 474, 366, 160, 51, 386, 438, 435, 280, 322, 407, 16, 82, 47, 92, 354, 390, 96, 351, 341, 196, 9, 92, 432, 109, 480, 36, 50, 197, 215, 221, 465, 70, 479, 370, 264, 254, 116, 28, 263, 388, 360, 72, 228, 156, 144, 2, 49, 400, 490, 397, 412, 400, 111, 396, 206, 283, 468, 329, 380, 145, 390, 95, 306, 225, 402, 236, 139, 375, 315, 191, 160, 204, 76, 225, 107, 244, 160, 299, 136, 89, 286, 15, 194, 328, 76, 25, 50, 323, 87, 285, 486, 165, 341, 218, 234, 26, 68, 447, 215, 111, 263, 435, 96, 480, 213, 456, 108, 71, 13, 120, 395, 105, 87, 316, 278, 400, 438, 413, 485, 70, 92, 416, 79, 314, 150, 286, 311, 457, 332, 428, 15, 431, 222, 288, 372, 290, 90, 487, 175, 56, 181, 227, 327, 335, 378, 13, 415, 16, 468, 217, 139, 278, 266, 292, 3, 341, 454, 31, 442, 48, 206, 374, 59, 80, 198, 384, 114, 182, 454, 96, 228, 494, 349, 314, 419, 9, 192, 346, 25, 190, 451, 346, 275, 73, 486, 119, 399, 406, 473, 215, 489, 126, 176, 323, 113, 163, 430, 18, 454, 460, 247, 62, 222, 487, 270, 73, 484, 150, 43, 327, 63, 26, 8, 303, 322, 80, 294, 183, 417, 347, 39, 314, 12, 161, 393, 95, 357, 469, 270, 40, 386, 408, 440, 149, 151, 268, 177, 157, 86, 17, 466, 260, 352, 428, 9, 138, 163, 446, 144, 251, 335, 26, 421, 65, 303, 423, 325, 465, 231, 10, 248, 384, 404, 320, 120, 494, 181, 160, 338, 474, 313, 38, 398, 361, 413, 63, 494, 412, 111, 266, 330, 418, 370, 145, 240, 486, 340, 462, 217, 347, 106, 76, 264, 58, 286, 108, 156, 207, 494, 448, 224, 100, 124, 335, 367, 1, 99, 375, 230, 341, 44, 332, 326, 384, 305, 425, 268, 493, 356, 289, 230, 196, 437, 304, 402, 79, 113, 355, 131, 394, 324, 388, 232, 271, 384, 140, 419, 258, 497, 51, 325, 215, 21, 353, 363, 251, 107, 339, 139, 225, 379, 353, 370, 172, 404, 4, 269, 355, 307, 331, 253, 61, 26, 236, 75, 230, 457, 38, 56, 430, 30, 472, 352, 270, 246, 23, 112, 30, 108, 434, 3, 207, 449, 14, 51, 196, 197, 438, 102, 245, 452, 165, 486, 444, 279, 184, 174, 174, 8, 232, 78, 260, 226, 328, 306, 363, 63, 178, 27, 401, 132, 137, 304, 253, 317, 260, 242, 99, 134, 84, 259, 8, 386, 450, 417, 104, 176, 90, 244, 248, 6, 250, 102, 10, 413, 128, 484, 162, 193, 38, 245, 27, 320, 191, 158, 365, 274, 306, 340, 125, 198, 457, 91, 430, 422, 475, 360, 427, 84, 142, 294, 143, 337, 122, 174, 250, 82, 445, 65, 166, 218, 201, 17, 102, 65, 352, 25, 149, 108, 31, 182, 268, 183, 264, 69, 494, 390, 366, 281, 89, 305, 320, 117, 86, 39, 229, 333, 416, 375, 12, 297, 116, 284, 164, 225, 416, 244, 493, 466, 340, 496, 66, 346, 188, 373, 203, 213, 449, 61, 108, 120, 366, 281, 388, 401, 123, 354, 469, 267, 407, 375, 132, 390, 368, 420, 232, 97, 404, 145, 48, 141, 308, 193, 143, 475, 72, 289, 253, 329, 343, 327, 232, 465, 158, 34, 80, 3, 95, 93, 283, 16, 155, 360, 306, 271, 15, 235, 49, 411, 337, 3, 498, 481, 269, 2, 370, 242, 446, 73, 97, 378, 169, 198, 32, 302, 87, 487, 368, 226, 86, 422, 358, 384, 345, 71, 369, 104, 46, 194, 61, 4, 234, 496, 111, 26, 55, 296, 145, 216, 404, 399, 493, 367, 259, 193, 82, 360, 400, 446, 16, 350, 225, 286, 14, 240, 25, 323, 191, 190, 460, 65, 393, 355, 440, 462, 381, 487, 40, 393, 223, 37, 140, 300, 433, 46, 293, 284, 344, 198, 220, 230, 336, 485, 409, 339, 197, 483, 10, 126, 445, 253, 124, 78, 474, 453, 422, 136, 264, 3, 253, 71, 252, 242, 155, 149, 202, 95, 211, 114, 362, 235, 469, 144, 436, 425, 329, 70, 38, 257, 150, 14, 279, 171, 156, 486, 337, 66, 383, 341, 251, 159, 416, 251, 39, 208, 85, 236, 233, 476, 293, 365, 299, 43, 315, 13, 387, 71, 68, 172, 126, 479, 358, 441, 481, 90, 103, 496, 315, 372, 73, 148, 267, 208, 313, 451, 475, 109, 91, 15, 176, 249, 50, 434, 156, 244, 93, 363, 93, 89, 462, 185, 497, 268, 486, 133, 423, 231, 423, 314, 252, 365, 335, 464, 381, 204, 359, 107, 433, 490, 465, 390, 93, 306, 341, 441, 299, 3, 49, 407, 240, 194, 347, 364, 493, 255, 209, 256, 126, 206, 479, 436, 132, 279, 105, 273, 271, 17, 142, 190, 397, 307, 49, 151, 155, 337, 40, 391, 411, 355, 208, 375, 201, 240, 303, 384, 276, 151, 277, 190, 74, 348, 479, 358, 8, 87, 131, 228, 268, 482, 141, 393, 152, 360, 111, 411, 74, 185, 183, 184, 154, 115, 220, 464, 112, 152, 107, 86, 224, 76, 359, 216, 340, 391, 375, 279, 467, 297, 235, 375, 478, 429, 282, 389, 286, 425, 228, 38, 31, 216, 463, 337, 151, 68, 357, 26, 75, 179, 226, 8, 236, 116, 489, 209, 72, 226, 192, 92, 319, 454, 92, 89, 143, 5, 161, 396, 394, 12, 74, 342, 212, 43, 480, 125, 141, 326, 447, 67, 443, 258, 167, 175, 43, 411, 165, 128, 407, 385, 499, 378, 311, 235, 428, 247, 111, 297, 469, 200, 299, 179, 361, 235, 402, 302, 178, 222, 383, 337, 399, 416, 215, 404, 158, 63, 152, 427, 129, 29, 74, 264, 450, 212, 272, 279, 425, 411, 497, 438, 486, 64, 277, 59, 205, 180, 419, 341, 322, 115, 122, 143, 258, 300, 252, 378, 434, 123, 353, 365, 227, 361, 139, 171, 287, 9, 281, 135, 72, 433, 160, 427, 7, 97, 287, 364, 5, 304, 367, 179, 357, 322, 390, 27, 366, 277, 25, 217, 396, 492, 373, 56, 222, 278, 37, 299, 437, 348, 475, 293, 73, 63, 140, 291, 240, 483, 497, 326, 95, 45, 437, 329, 104, 261, 150, 297, 29, 33, 491, 340, 417, 243, 166, 423, 341, 337, 324, 292, 423, 60, 153, 282, 233, 442, 454, 316, 17, 42, 342, 78, 296, 173, 237, 3, 295, 93, 407, 467, 315, 113, 199, 40, 252, 38, 148, 4, 401, 353, 377, 116, 31, 281, 466, 264, 223, 420, 80, 92, 463, 423, 22, 259, 96, 260, 114, 243, 205, 22, 63, 21, 135, 262, 61, 239, 152, 61, 95, 54, 415}
	// arr := []int{1, 2, 3, 4, 5, 6}
	// arr2 := []int{3, 2, 1, 6, 5, 4}
	var next = &ListNode{Val: arr[1]}
	var pre = &ListNode{Val: arr[0], Next: next}

	for i := 2; i < len(arr); i++ {
		l := &ListNode{
			Val: arr[i],
		}
		next.Next = l
		next = l
	}

	head := reverseKGroup(pre, 711)
	i := 0
	for {
		if len(arr)-i*711 < 711 {
			break
		}
		tempArr := arr[i*711 : (i+1)*711]
		for j := 0; j < len(tempArr)/2; j++ {
			tempArr[j], tempArr[len(tempArr)-j-1] = tempArr[len(tempArr)-j-1], tempArr[j]
		}
		i++
	}

	// head := reverseKGroup(pre, 3)
	cur := head
	result := make([]int, 0, len(arr))
	for cur != nil {
		result = append(result, cur.Val)
		cur = cur.Next
	}

	if len(arr2) != len(result) {
		fmt.Println("error")
		return
	}

	for i := 0; i < len(arr2); i++ {
		if arr[i] != result[i] {
			fmt.Println("error2")
			return
		}
	}

	fmt.Println()
}
